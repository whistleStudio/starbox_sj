# 循线机器人

[[toc]]

<br>
<br>

<img src="/images/docimg/微信图片_20250220113450.jpg" width="60%">

## 🎯 项目目标

让机器人沿着黑线或其他对比明显的线路行走。

<br>

## 📖 原理方法

- 通过传感器实时反馈线路信息，调整机器人的行走方向。

- 灰度传感器可用于检测颜色的深浅，进而可区分某些特定场景的路径，如白底黑线。

<img src="/images/docimg/Snipaste_2025-02-20_09-08-27.png">


机器人车头中央板载了2个灰度传感器，探头朝下，用于检测地面灰度值大小。

机器人行进过程中，任一灰度传感器偏离黑线边进行纠正。

<img src="/images/docimg/Snipaste_2025-02-20_09-02-08.png">

<br>

## 🔧 操作步骤

1 在地面上绘制一条对比明显的线路。

2 将灰度传感器或视觉传感器安装在机器人上。

3 编写程序，使机器人根据传感器反馈的线路信息调整方向。

4 测试机器人在不同线路条件下的表现。

<br>

## 💻 示例程序

### 1） 【在线】灰度测试

在线模式下运行，检测场地黑线路径与其他区域的灰度值大小。

<img src="/images/docimg/Snipaste_2025-02-20_09-17-46.png">

<img src="/images/docimg/Snipaste_2025-02-20_09-18-26.png">

颜色越深越趋近于黑色时，数值越小；越趋近于白色，数值越大。

<img src="/images/docimg/Snipaste_2025-02-20_09-22-13.png">

<br>
<br>

### 2） 循线功能（低速）实现

<a href="/tutorial/hellocardoc/sb3/循线功能（低速）实现.sb3">点击下载程序：循线功能（低速）实现.sb3</a>

假设黑线测得数值在300-500间浮动，非黑线区域为800-1000；那么，我们可选择600作为边界值，以区分黑色路径及其他区域。

相应地，智能车库中的 **灰度阈值** 指的就是这里的边界值。

<img src="/images/docimg/Snipaste_2025-02-20_09-39-18.png">

积木`读取循迹传感器对的值`用于记录双灰度的读值情况。单个灰度传感器读值小于灰度阈值时，返回数字1；否则，返回0。

<img src="/images/docimg/Snipaste_2025-02-20_09-56-54.png">

<img src="/images/docimg/Snipaste_2025-02-20_09-02-08.png">

<img src="/images/docimg/Snipaste_2025-02-20_09-42-31.png">

循线程序为：

<img src="/images/docimg/Snipaste_2025-02-20_09-58-22.png">

<br>
<br>

### 3） 循线功能（高速）实现

<a href="/tutorial/hellocardoc/sb3/循线功能（高速）实现.sb3">点击下载程序：循线功能（高速）实现.sb3</a>

然而，当机器人以较高速度行驶时，受惯性影响，可能会出现纠正不及时的情况，以致双灰度均偏离黑线。

<img src="/images/docimg/Snipaste_2025-02-20_10-03-23.png">

完全偏离共两种情况，双灰度的返回值均为 **00** ，我们需要加以区分，以控制机器人朝正确的方向进行纠正。

拆分双灰度从完全落在黑线到完全偏离黑线的整个过程，可得如下关系：

<img src="/images/docimg/Snipaste_2025-02-20_10-06-19.png">

由此可见，区分点在于中间的过渡过程。创建变量 `中间态` 用以记录，并在两种过渡阶段赋予不同的数值，进而在完全偏离时区分。

机器人些许偏离路径，仅有单个灰度离开黑线时，设置较小的速度差进行平缓纠正；

机器人大幅度偏离路径，双灰度均离开黑线时，设置较大的速度差进行迅速纠正。

<img src="/images/docimg/Snipaste_2025-02-20_10-24-47.png">

<br>
<br>

## 📺 演示视频

(催更中🔥🔥🔥)